<!DOCTYPE html>
<meta charset="utf-8">
<script src="//d3js.org/d3.v5.min.js"></script>
<style> circle {fill: lightblue; stroke: black;} </style>
<body onload='init()'>
  <h1>Hello Github Pages!</h1>
  <div>
    <button>First Case</button>
    <button>Peak</button>
    <button>Lowest</button>
</div>
 <svg id="covid_viz"></svg>

<script>
  async function init() {
    data = await d3.csv("https://raw.githubusercontent.com/venugopalthati/COVID19_US/gh-pages/us_covid_cases.csv");
    width = 500;
    height = 500;
    
    const dateParser = d3.timeParse("%m/%d/%Y")
    
    var x = d3.scaleTime()
    .domain(d3.extent(data, function(d) { 
      return new Date(d.date); 
    }))
    .range([0, width]);
    
    var y = d3.scaleLinear()
    .domain([0, d3.max(data, function(d){
      var a = [d.daily_cases];
      return d3.max(a)
      })])
    .range([height, 0]);
    
    d3.select('svg').append('g')
    .attr('transform','translate('+50+','+50+')')
    .call(d3.axisBottom(x)
      .tickFormat(d3.timeFormat("%x")).tickValues(data.map(function(d) { return new Date(d.date)}) ));

    d3.select('svg').append('g')
    .attr('transform','translate('+50+','+450+')')
    .call(d3.axisLeft(y).ticks(4));
    
    var svg = d3.select("svg")
      .attr("width",  width)
      .attr("height", height);

    var g = svg.append("g")
      .attr("transform","translate("+50+","+50+")")
      .selectAll("circle")                      
      .data(data)
      .enter().append("circle")
      .attr("cx", function(d) { return new Date(d["date"]); } )
      .attr("cy", function(d) { return parseInt(d["daily_cases"]); } )
      .attr("r", 5);
  }
  
</script>
</body>
